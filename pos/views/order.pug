extends layout

block content
	style.
		div.total {
			display: flex;
		}

		div.menu, div.list {
			margin: 0 auto;
		}
		

		table, tr, th, td {
			border: 1px solid mediumaquamarine;
			border-collapse: collapse;
			text-align: center;
			padding: 10px;
		}

		tr.menu_header {
			
		}

		button {
			padding: 5px 30px;
			cursor: pointer;
		}

		div.list {
			width: 30%
		}

	h2 상품 주문 리스트
	div.total
		div.menu
			h3 #{o_table}번 테이블
			h3 고객 ID : #{o_buyer}
			
			div.menu_list
				table#menu
					tr.menu_header
						th 메뉴
						th 단가
						th 수량
						th 금액
					
					tbody
						td(colspan="2") 합계
						
				div.modal
					button.order 주문하기
		
		div.list
			each vo, index in PR
				button.list(data-code= vo.p_code) #{vo.p_name}
			
	script.
		document.querySelector("div.list").addEventListener("click", (e) => {
			let button = e.target
			const p_name = button.innerText;
			const p_code = button.dataset.code;
			//- alert(p_code)

			fetch(`/order/insert?p_code=${p_code}`)
			.then(res=>res.json())
			.then(result => {
				if(result) {
					//- alert("요기니"+JSON.stringify(result))
					let insert_menu = document.querySelector("tbody") // "table#menu")
					let add_tr = document.createElement("tr")
					let add_td = document.createElement("td")

					//- add_td.innerText = result.p_name
					//- add_tr.appendChild(add_td)

					add_tr.innerHTML = "<td data-code=" + result.p_code +">" + result.p_name + "</td>" 
					add_tr.innerHTML += "<td>" + result.p_price + "</td>"
					add_tr.innerHTML += "<td>" + 1 + "</td>"
					add_tr.innerHTML += "<td>" + result.p_price * 1 + "</td>"

					//- add_td1 = document.createElement("td")
					//- add_td1.innerText = 
					//- add_tr.innerHTML = "<td>" + p_name + "</td>"
					//- add_tr.innerHTML = "<td>" + p_name + "</td>"

					insert_menu.appendChild(add_tr);

				}
				//- alert("여기니"+result)
			})
		})

		document.querySelector("button.order").addEventListener("click", (e)=>{
			document.location.href = "/";
		})